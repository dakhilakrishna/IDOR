Patchwork for IDOR vulnerability

Detection in logs:

Same IP addresses accessing various portions of accounts, e.g. acc_ID=1 (attacker can alter account ID to 2), with continual changes in ID numbers from the same IP addresses within a particular period, indicating the Insecure Direct Object being accessed. 

If the source IP address has a successful HTTP status code of 200, a failure code of 4xx, or any other code, it means that efforts were made but the code was not successfully exploited. 

Rule of Simple Correlation Reasoning: WAF/RASP logs contain acc_ID=1 to 1000 AND Status Codes 200 AND SAME Source IP addresses: x.x.x.x 

Examine web application logs, WAF, and RASP for information on what is accessed from a third party. 

Examine the results of the vulnerability scanners and see whether the application has any new vulnerabilities.

Preventative Actions 

Ensure that access is restricted and that the resources are within our control. Like resources mapped to the owner using a non-sequence key or a random non-guessable integer. 
Before issuing the resource when the user wants it, check the user's authorisation. In the application, a powerful User role function should be implemented. Before releasing the resource, make sure the user role and hash are correct. 
Instead of mapping the item with a straight id, use a hash in this situation. It's a good idea to add salt with hash to make it more challenging.


Burpsuite:

Attackers commonly employ the Burp Suite Tool to carry out such attacks. The measures to be taken are as follows: 

1. Capture the Request: First and foremost, an attacker must choose a target website on which to launch an IDOR assault. The website is then added to the scope, and a spider is used to collect all URLs with certain specifications. 

2. Filter the variables. Request: After the first step, we'll use the parameter filters to filter our collected request. Only that parameter or Injection points will be chosen by an attacker as targets for their assaults.

3. Forward request to Repeater: If an attacker discovers an injection point where they may run IDOR, the request will be forwarded to the repeater. www.xyz.com/myaccount/uid=19 is an example of a potentially vulnerable URL. The "UID" appears to be susceptible in this case. 

4. Parameter tampering: Now that the attacker obtains the susceptible injection point, they will attempt to carry out the IDOR attack using social engineering or the pattern specified in the injection point. For example, an attacker may alter uid from 19 to 20, resulting in the account of another user with id number 20 being opened.
